<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Organization Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@latest"></script>
  </head>

  <body class="bg-gray-100">
    <div id="navbar"></div>

    <div class="container mx-auto p-4 sm:p-6">
      <h1 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6">Organization Dashboard</h1>

      <!-- Main Cards -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-4 sm:mb-6">
        <!-- Drivers Card -->
        <a href="organization_dashboard/drivers.html" class="block">
          <div class="bg-white p-3 sm:p-4 rounded-lg shadow-md">
            <h2 class="font-semibold text-center text-base sm:text-lg">Drivers</h2>
          </div>
        </a>

        <!-- Map Card -->
        <a href="map/vehicles.html" class="block">
          <div class="bg-white p-3 sm:p-4 rounded-lg shadow-md">
            <h2 class="font-semibold text-center text-base sm:text-lg">Map</h2>
          </div>
        </a>

        <!-- Comments Card -->
        <a href="organization_dashboard/reports.html" class="block">
          <div class="bg-white p-3 sm:p-4 rounded-lg shadow-md">
            <h2 class="font-semibold text-center text-base sm:text-lg">Reports</h2>
          </div>
        </a>

        <!-- Blank Card -->
        <a href="organization_dashboard/driver.html" class="block">
          <div class="bg-white p-3 sm:p-4 rounded-lg shadow-md">
            <h2 class="font-semibold text-center text-base sm:text-lg">Blank Card</h2>
          </div>
        </a>
      </div>

      <!-- Driver Comments Table -->
      <div class="bg-white rounded-lg shadow-md p-3 sm:p-4">
        <h3 class="font-semibold text-base sm:text-lg mb-3 sm:mb-4">Driver Comments</h3>
        <table id="selection-table" class="min-w-full border-collapse rounded-lg text-sm sm:text-base">
          <thead>
            <tr class="bg-gray-200">
              <th class="py-1 px-2 sm:py-2 sm:px-4 text-left rounded-l-lg">Driver Name</th>
              <th class="py-1 px-2 sm:py-2 sm:px-4 text-left">Comments</th>
              <th class="py-1 px-2 sm:py-2 sm:px-4 text-left">Created</th>
              <th class="py-1 px-2 sm:py-2 sm:px-4 text-left rounded-r-lg">Reporter</th>
            </tr>
          </thead>
          <tbody>
            <!-- Dynamically filled rows will go here -->
          </tbody>
        </table>
      </div>
    </div>

    <script>
      // Example JavaScript for populating table, etc.
      const feedbackData = [
          { 
              first_name: 'John', 
              last_name: 'Doe', 
              driver: 'John Smith', 
              report: 'Great performance!', 
              created_at: '30/08/2024, 19:18:18' 
          },
          { 
              first_name: 'Jane', 
              last_name: 'Smith', 
              driver: 'Emily Johnson', 
              report: 'Needs improvement in punctuality.', 
              created_at: '30/08/2024, 19:20:00' 
          },
          { 
              first_name: 'Mike', 
              last_name: 'Johnson', 
              driver: 'Chris Lee', 
              report: 'Excellent feedback from customers.', 
              created_at: '30/08/2024, 19:22:15' 
          },
          { 
              first_name: 'Emily', 
              last_name: 'Davis', 
              driver: 'Anna Brown', 
              report: 'Shows great leadership skills.', 
              created_at: '30/08/2024, 19:25:30' 
          },
          { 
              first_name: 'Chris', 
              last_name: 'Lee', 
              driver: 'David Wilson', 
              report: 'Good team player but needs to work on communication.', 
              created_at: '30/08/2024, 19:27:45' 
          },
          { 
              first_name: 'Tharick', 
              last_name: 'Jairam', 
              driver: 'John Smith', 
              report: 'sadfsadf', 
              created_at: '30/08/2024, 19:18:18' 
          },
          { 
              first_name: 'Sarah', 
              last_name: 'Johnson', 
              driver: 'Michael Brown', 
              report: 'Overall performance is satisfactory.', 
              created_at: '30/08/2024, 19:30:00' 
          },
          { 
              first_name: 'Daniel', 
              last_name: 'Williams', 
              driver: 'Lisa Green', 
              report: 'Needs to improve on time management.', 
              created_at: '30/08/2024, 19:32:15' 
          },
          { 
              first_name: 'Laura', 
              last_name: 'Martinez', 
              driver: 'Emily White', 
              report: 'Great at problem-solving and very reliable.', 
              created_at: '30/08/2024, 19:35:00' 
          },
          { 
              first_name: 'James', 
              last_name: 'Garcia', 
              driver: 'Oliver Smith', 
              report: 'Excellent communication skills and teamwork.', 
              created_at: '30/08/2024, 19:37:30' 
          },
          { 
              first_name: 'Nina', 
              last_name: 'Roberts', 
              driver: 'Sophia Johnson', 
              report: 'Consistent and dependable with high-quality work.', 
              created_at: '30/08/2024, 19:40:00' 
          }
      ];



      const tableBody = document.querySelector("#selection-table tbody");

      const firstThreeFeedbacks = feedbackData.slice(0, 3);

      firstThreeFeedbacks.forEach(data => {
          const row = document.createElement("tr");
          row.classList.add("border-b");

          // const dateStr = '30/08/2024, 19:18:18';
          const parsedDate = dateFns.parse(data.created_at, 'dd/MM/yyyy, HH:mm:ss', new Date());
          const readableDate = dateFns.format(parsedDate, 'MMMM d, yyyy h:mm a');
          console.log(readableDate); // Output: "August 30, 2024 7:18 PM"

          
          row.innerHTML = `
              <td class="py-1 text-sm px-2 sm:py-2 sm:px-4">${data.driver}</td>
              <td class="py-1 text-sm px-2 sm:py-2 sm:px-4">${data.report}</td>
              <td class="py-1 text-sm px-2 sm:py-2 sm:px-4">${readableDate}</td>
              <td class="py-1 text-sm px-2 sm:py-2 sm:px-4">${data.first_name} ${data.last_name}</td>
          `;
          
          tableBody.appendChild(row);
      });
    </script>


    <script>

        function logout(event) {
            event.preventDefault(); // Prevent the default anchor behavior
            localStorage.setItem('userRegistered', JSON.stringify({})); // Clear local storage
            console.log("User logged out");
            // Redirect to the register page
            window.location.href = '/template/signup.html';
        }
        // Function to hide elements by ID
        function hideElementById(id) {
            const element = document.getElementById(id);
            if (element) {
                element.style.display = "none";
            }
        }

        // Function to show elements by ID
        function showElementById(id) {
            const element = document.getElementById(id);
            if (element) {
                element.style.display = "block";
            }
        }

        // Function to toggle profile dropdown visibility
        function toggleProfileDropdown() {
            const dropdown = document.getElementById('profile-dropdown');
            dropdown.classList.toggle('hidden');
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
            if (!event.target.matches('#profile-button')) {
                const dropdowns = document.getElementsByClassName('absolute');
                for (let i = 0; i < dropdowns.length; i++) {
                    const openDropdown = dropdowns[i];
                    if (!openDropdown.classList.contains('hidden')) {
                        openDropdown.classList.add('hidden');
                    }
                }
            }
        }


        fetch("navbar.html")
        .then((response) => response.text())
        .then((data) => {
            document.getElementById("navbar").innerHTML = data;

            // Check user login status
            const userLoggedIn = JSON.parse(localStorage.getItem("userRegistered"));
            console.log("userLoggedIn:", userLoggedIn);

            if (userLoggedIn && userLoggedIn.token) {
                console.log("userLoggedIn hide");
                hideElementById("login-link");
                hideElementById("register-link");
                showElementById("profile-menu");
            } else {
                showElementById("login-link");
                showElementById("register-link");
                hideElementById("profile-menu");
            }

            // Set up mobile menu toggle functionality
            // Assuming you will define this function
            // setupMobileMenuToggle();
        })
        .catch((error) => console.error("Error loading navbar:", error));
    </script>

    <!-- <script>
        // Function to hide elements by ID
        function hideElementById(id) {
            const element = document.getElementById(id);
            if (element) {
                element.style.display = "none";
            }
        }

        // Function to show elements by ID
        function showElementById(id) {
            const element = document.getElementById(id);
            if (element) {
                element.style.display = "block";
            }
        }

        // Function to toggle profile dropdown visibility
        function toggleProfileDropdown() {
            const dropdown = document.getElementById('profile-dropdown');
            dropdown.classList.toggle('hidden');
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function(event) {
            if (!event.target.matches('#profile-button')) {
                const dropdowns = document.getElementsByClassName('absolute');
                for (let i = 0; i < dropdowns.length; i++) {
                    const openDropdown = dropdowns[i];
                    if (!openDropdown.classList.contains('hidden')) {
                        openDropdown.classList.add('hidden');
                    }
                }
            }
        }

        fetch("navbar.html")
        .then((response) => response.text())
        .then((data) => {
            document.getElementById("navbar").innerHTML = data;

            // Check user login status
            const userLoggedIn = JSON.parse(localStorage.getItem("userRegistered"));
            console.log("userLoggedIn:", userLoggedIn);

            if (userLoggedIn && userLoggedIn.token) {
                console.log("userLoggedIn hide");
                hideElementById("login-link");
                hideElementById("register-link");
                showElementById("profile-menu");
            } else {
                showElementById("login-link");
                showElementById("register-link");
                hideElementById("profile-menu");
            }

            // Set up mobile menu toggle functionality
            // Assuming you will define this function
            // setupMobileMenuToggle();
        })
        .catch((error) => console.error("Error loading navbar:", error));
    </script> -->

    <!-- <script>
      // Function to hide elements by ID
      function hideElementById(id) {
        const element = document.getElementById(id);
        if (element) {
          element.style.display = "none";
        }
      }

      // Function to show elements by ID
      function showElementById(id) {
        const element = document.getElementById(id);
        if (element) {
          element.style.display = "block";
        }
      }

      // Fetch the navbar and check registration status
      fetch("navbar.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("navbar").innerHTML = data;

          // Check user registration status
          const userRegistered = JSON.parse(
            localStorage.getItem("userRegistered")
          );

          if (userRegistered && userRegistered.registered) {
            hideElementById("login-link");
            hideElementById("register-link");
            showElementById("profile-link");
          }

          // Set up mobile menu toggle functionality
          document
            .querySelectorAll("[data-collapse-toggle]")
            .forEach((button) => {
              button.addEventListener("click", function () {
                const mobileMenu = document.getElementById("mobile-menu-2");
                if (mobileMenu) {
                  mobileMenu.style.display =
                    mobileMenu.style.display === "none" ||
                    mobileMenu.style.display === ""
                      ? "block"
                      : "none";
                }
              });
            });
        })
        .catch((error) => console.error("Error loading navbar:", error));
    </script> -->
  </body>
</html>
